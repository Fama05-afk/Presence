<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Section Bordeaux - Suivi de Pr√©sence - Goudi Aljuma</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        body.night-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 100%);
        }
        
        .hidden {
            display: none !important;
        }
        
        /* PAGE DE CONNEXION */
        .login-page {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .login-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 60px 50px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 480px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.5);
            animation: slideUp 0.6s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 40px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .login-title {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .login-subtitle {
            font-size: 16px;
            color: #6B7280;
            margin-bottom: 40px;
            font-weight: 500;
        }
        
        .login-input {
            width: 100%;
            padding: 18px 20px;
            font-size: 16px;
            border: 2px solid #E5E7EB;
            border-radius: 15px;
            margin-bottom: 20px;
            transition: all 0.3s;
            background: #F9FAFB;
        }
        
        .login-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }
        
        .login-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }
        
        .login-error {
            background: #FEE2E2;
            color: #DC2626;
            padding: 14px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid #DC2626;
            font-weight: 600;
        }
        
        /* CONTAINER PRINCIPAL */
        .main-container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* HEADER */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        body.night-mode .header {
            background: rgba(30, 41, 59, 0.95);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .logo-title {
            font-size: 42px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -1px;
        }
        
        body.night-mode .logo-title {
            background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: 18px;
            color: #6B7280;
            font-weight: 600;
        }
        
        body.night-mode .subtitle {
            color: #9CA3AF;
        }
        
        /* CONTROLS */
        .controls {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 16px 28px;
            border: none;
            border-radius: 15px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            color: #667eea;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid transparent;
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #667eea;
        }
        
        .control-btn.logout {
            background: linear-gradient(135deg, #f43f5e 0%, #dc2626 100%);
            color: white;
        }
        
        .control-btn.alert {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        
        .control-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        /* STATS */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.5);
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        body.night-mode .stat-card {
            background: rgba(30, 41, 59, 0.95);
        }
        
        .stat-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #6B7280;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        body.night-mode .stat-label {
            color: #9CA3AF;
        }
        
        /* TABLEAU */
        .table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.5);
            overflow-x: auto;
        }
        
        body.night-mode .table-container {
            background: rgba(30, 41, 59, 0.95);
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .table-title {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .presence-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 14px;
        }
        
        .presence-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px 12px;
            text-align: center;
            font-weight: 700;
            position: sticky;
            top: 0;
            z-index: 10;
            letter-spacing: 0.5px;
        }
        
        .presence-table th:first-child {
            border-radius: 15px 0 0 0;
        }
        
        .presence-table th:last-child {
            border-radius: 0 15px 0 0;
        }
        
        .presence-table th.name-column {
            text-align: left;
            min-width: 200px;
        }
        
        .presence-table th.date-column {
            min-width: 60px;
            font-size: 12px;
        }
        
        .presence-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #F3F4F6;
        }
        
        body.night-mode .presence-table td {
            border-bottom-color: #374151;
        }
        
        .presence-table tr:last-child td:first-child {
            border-radius: 0 0 0 15px;
        }
        
        .presence-table tr:last-child td:last-child {
            border-radius: 0 0 15px 0;
        }
        
        .presence-table td.name-cell {
            text-align: left;
            font-weight: 700;
            color: #1F2937;
            background: #F9FAFB;
        }
        
        body.night-mode .presence-table td.name-cell {
            color: #F3F4F6;
            background: #1F2937;
        }
        
        .presence-table tr.alert-row {
            background: linear-gradient(90deg, #FEE2E2 0%, #FEF2F2 100%);
        }
        
        body.night-mode .presence-table tr.alert-row {
            background: linear-gradient(90deg, #7F1D1D 0%, #991B1B 100%);
        }
        
        .presence-table tr.alert-row td.name-cell {
            background: #FEE2E2;
            color: #DC2626;
        }
        
        body.night-mode .presence-table tr.alert-row td.name-cell {
            background: #7F1D1D;
            color: #FCA5A5;
        }
        
        .presence-cell {
            cursor: pointer;
            padding: 10px;
            transition: all 0.2s;
            font-weight: 800;
            border-radius: 10px;
            min-width: 45px;
            display: inline-block;
        }
        
        .presence-cell:hover {
            transform: scale(1.15);
        }
        
        .presence-cell.present {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }
        
        .presence-cell.absent {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }
        
        .presence-cell.empty {
            background: #F3F4F6;
            color: #9CA3AF;
        }
        
        body.night-mode .presence-cell.empty {
            background: #374151;
            color: #6B7280;
        }
        
        .alert-badge {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            margin-left: 10px;
            font-weight: 800;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* NIGHT MODE TOGGLE */
        .night-mode-toggle {
            position: fixed;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            color: #667eea;
            border: none;
            padding: 14px 24px;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            z-index: 1000;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .night-mode-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.2);
            border-color: #667eea;
        }
        
        body.night-mode .night-mode-toggle {
            background: rgba(30, 41, 59, 0.95);
            color: #818cf8;
        }
        
        /* MODAL */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            max-width: 700px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.4s ease-out;
        }
        
        body.night-mode .modal-content {
            background: #1e293b;
        }
        
        .modal-title {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
            text-align: center;
            letter-spacing: -0.5px;
        }
        
        .modal-close-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .modal-close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
        }
        
        .alert-item {
            background: linear-gradient(135deg, #FEE2E2 0%, #FEF2F2 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #DC2626;
            transition: all 0.3s;
        }
        
        .alert-item:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.2);
        }
        
        body.night-mode .alert-item {
            background: linear-gradient(135deg, #7F1D1D 0%, #991B1B 100%);
        }
        
        .alert-item-name {
            font-weight: 800;
            color: #DC2626;
            font-size: 18px;
            margin-bottom: 6px;
        }
        
        body.night-mode .alert-item-name {
            color: #FCA5A5;
        }
        
        .alert-item-count {
            color: #B91C1C;
            font-weight: 700;
        }
        
        @media (max-width: 768px) {
            .presence-table {
                font-size: 12px;
            }
            
            .logo-title {
                font-size: 28px;
            }
            
            .stat-number {
                font-size: 36px;
            }
        }
    </style>
</head>
<body>
    <!-- PAGE DE CONNEXION -->
    <div id="loginPage" class="login-page">
        <div class="login-container">
            <div class="login-logo">üìã</div>
            <div class="login-title">Section Bordeaux</div>
            <div class="login-subtitle">Suivi de Pr√©sence - Goudi Aljuma</div>
            <div id="loginError" class="login-error hidden">
                ‚ùå Mot de passe incorrect
            </div>
            <input 
                type="password" 
                id="passwordInput" 
                class="login-input" 
                placeholder="Entrez votre mot de passe"
                onkeypress="if(event.key==='Enter') checkPassword()"
            >
            <button class="login-btn" onclick="checkPassword()">
                Se connecter
            </button>
            
            <button onclick="resetSystem()" style="width: 100%; padding: 12px; margin-top: 12px; background: #DC2626; color: white; border: none; border-radius: 15px; font-size: 14px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4); transition: all 0.3s;">
                üîÑ R√©initialiser (si probl√®me de connexion)
            </button>
            
            <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); border-radius: 12px; text-align: left;">
                <p style="font-size: 13px; color: #92400E; margin-bottom: 8px; font-weight: 700;">
                    üîí Mot de passe oubli√© ?
                </p>
                <p style="font-size: 12px; color: #92400E; margin-bottom: 10px;">
                    Pour r√©initialiser votre mot de passe de mani√®re s√©curis√©e, contactez l'administrateur :
                </p>
                <a href="mailto:famadiallodf@gmail.com?subject=R√©initialisation%20mot%20de%20passe%20Section%20Bordeaux&body=Bonjour,%0D%0A%0D%0AJe%20souhaite%20r√©initialiser%20mon%20mot%20de%20passe%20pour%20le%20syst√®me%20de%20suivi%20de%20pr√©sence.%0D%0A%0D%0AMon%20nom%20:%20%0D%0AMon%20email%20:%20%0D%0A%0D%0AMerci." style="display: inline-block; padding: 8px 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; border-radius: 8px; font-size: 13px; font-weight: 700; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
                    üìß Envoyer une demande
                </a>
            </div>
        </div>
    </div>

    <!-- APPLICATION PRINCIPALE -->
    <div id="mainApp" class="hidden">
        <button class="night-mode-toggle" onclick="toggleNightMode()">üåô Mode Nuit</button>
        
        <div class="main-container">
            <div class="header">
                <div class="logo-container">
                    <div class="logo-icon">üìã</div>
                    <div class="logo-title">Section Bordeaux</div>
                </div>
                <div class="subtitle">Suivi de Pr√©sence - Goudi Aljuma</div>
            </div>
            
            <div class="controls">
                <button class="control-btn alert" onclick="showAlerts()">
                    ‚ö†Ô∏è Alertes (<span id="alertCountBtn">0</span>)
                </button>
                <button class="control-btn" onclick="showMemberManagement()">
                    üë• G√©rer les Membres
                </button>
                <button class="control-btn" onclick="exportData()">
                    üíæ Exporter
                </button>
                <button class="control-btn logout" onclick="logout()">
                    üö™ D√©connexion
                </button>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-number" id="totalMembers">42</div>
                    <div class="stat-label">Membres</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìÖ</div>
                    <div class="stat-number" id="totalDates">0</div>
                    <div class="stat-label">S√©ances</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö†Ô∏è</div>
                    <div class="stat-number" id="alertCount">0</div>
                    <div class="stat-label">Alertes</div>
                </div>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="table-title">üìä Tableau des Pr√©sences</div>
                </div>
                <table class="presence-table" id="presenceTable">
                    <thead id="tableHeader"></thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL ALERTES -->
    <div id="alertModal" class="modal-overlay hidden" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-title">‚ö†Ô∏è Alertes Actives</div>
            <div id="alertList"></div>
            <button class="modal-close-btn" onclick="closeModal()">Fermer</button>
        </div>
    </div>

    <!-- MODAL GESTION DES MEMBRES -->
    <div id="memberModal" class="modal-overlay hidden" onclick="closeMemberModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-title">üë• G√©rer les Membres</div>
            
            <!-- Ajouter un membre -->
            <div style="background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                <h3 style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px; font-size: 20px; font-weight: 800;">‚ûï Ajouter un Membre</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; font-weight: 700; margin-bottom: 8px; color: #667eea; font-size: 14px;">
                            Pr√©nom
                        </label>
                        <input 
                            type="text" 
                            id="newMemberPrenom" 
                            class="login-input"
                            style="margin-bottom: 0;"
                            placeholder="Pr√©nom"
                        >
                    </div>
                    <div>
                        <label style="display: block; font-weight: 700; margin-bottom: 8px; color: #667eea; font-size: 14px;">
                            Nom
                        </label>
                        <input 
                            type="text" 
                            id="newMemberNom" 
                            class="login-input"
                            style="margin-bottom: 0;"
                            placeholder="Nom"
                        >
                    </div>
                </div>
                <button class="modal-close-btn" onclick="addMember()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); margin-bottom: 0; box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);">
                    ‚ûï Ajouter ce Membre
                </button>
            </div>
            
            <div id="memberError" class="login-error hidden"></div>
            <div id="memberSuccess" class="hidden" style="background: #D1FAE5; color: #065F46; padding: 14px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #10B981; font-weight: 700;">
                ‚úÖ Op√©ration r√©ussie !
            </div>
            
            <!-- Liste des membres -->
            <div style="background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%); padding: 25px; border-radius: 15px; margin-bottom: 20px; max-height: 400px; overflow-y: auto;">
                <h3 style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px; font-size: 20px; font-weight: 800;">üìã Liste des Membres</h3>
                <div id="memberList"></div>
            </div>
            
            <button class="modal-close-btn" onclick="closeMemberModal()" style="background: linear-gradient(135deg, #6B7280 0%, #4B5563 100%);">
                Fermer
            </button>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        
        const defaultMembres = [
            {prenom: "Mariama", nom: "Barry"},
            {prenom: "Bathie", nom: "Diallo"},
            {prenom: "Fadiama", nom: "Diallo"},
            {prenom: "Fama", nom: "Diallo"},
            {prenom: "Mao", nom: "Diop"},
            {prenom: "Mouhamed Lamine", nom: "Diop"},
            {prenom: "Astou", nom: "Fall"},
            {prenom: "Ndeye Absa", nom: "Fall"},
            {prenom: "Arona", nom: "Fall"},
            {prenom: "Mariama", nom: "Gassama"},
            {prenom: "Cheikh Tidiane", nom: "Gaye"},
            {prenom: "Mbaye Niang", nom: "Gaye"},
            {prenom: "Serigne Moustapha", nom: "Gueye"},
            {prenom: "A√Øssatou", nom: "K√©b√©"},
            {prenom: "Tidiane", nom: "K√©b√©"},
            {prenom: "Ndat√©", nom: "L√¥"},
            {prenom: "Diarra", nom: "L√¥"},
            {prenom: "Ndiaya", nom: "L√¥"},
            {prenom: "Khadija", nom: "Mbodj"},
            {prenom: "Rokhaya", nom: "Mbodj"},
            {prenom: "Souleymane", nom: "Mbodj"},
            {prenom: "Sophie", nom: "Mbodji"},
            {prenom: "Mame Cheikh Tidiane", nom: "Ndoye"},
            {prenom: "Ndeye Diop", nom: "Ndiaye"},
            {prenom: "Aly", nom: "Ndiaye"},
            {prenom: "Moussa", nom: "Nguirane"},
            {prenom: "Maodo", nom: "Niang"},
            {prenom: "Khalifa Babacar", nom: "Niang"},
            {prenom: "A√Øda Mb√®ne", nom: "Samb"},
            {prenom: "Ass", nom: "Samb"},
            {prenom: "Assane", nom: "Samb"},
            {prenom: "Bara", nom: "Samb"},
            {prenom: "Madiele", nom: "Samb"},
            {prenom: "Mame Saer", nom: "Samb"},
            {prenom: "Mame Dame", nom: "Samb"},
            {prenom: "Mar√®me", nom: "Samba"},
            {prenom: "Mame Moussa", nom: "Sarr"},
            {prenom: "Fatou", nom: "Seck"},
            {prenom: "Ass", nom: "Seye"},
            {prenom: "Sidy", nom: "Soumar√©"},
            {prenom: "Mouhamed", nom: "Thiam"},
            {prenom: "Ibrahima", nom: "Wade"}
        ];
        
        let membres = [];
        
        function loadMembres() {
            const saved = localStorage.getItem('daaraMembres');
            if (saved) {
                membres = JSON.parse(saved);
            } else {
                membres = [...defaultMembres];
                // Trier la liste initiale par nom puis pr√©nom
                membres.sort((a, b) => {
                    const nomCompare = a.nom.localeCompare(b.nom, 'fr');
                    if (nomCompare !== 0) return nomCompare;
                    return a.prenom.localeCompare(b.prenom, 'fr');
                });
                saveMembres();
            }
        }
        
        function saveMembres() {
            localStorage.setItem('daaraMembres', JSON.stringify(membres));
        }
        
        function generateThursdayDates() {
            const dates = [];
            const startDate = new Date(2026, 0, 1);
            const endDate = new Date(2026, 11, 31);
            
            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                const day = d.getDay();
                if (day === 4) {
                    dates.push(new Date(d));
                }
            }
            return dates;
        }
        
        const weekendDates = generateThursdayDates();
        
        const correctPasswordHash = "a1dd395c19f3a1f7ff0e6bfe3ee6028e4373b41085a6da776ab02a8baf129abb";
        
        async function hashPassword(password) {
            const msgBuffer = new TextEncoder().encode(password);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }
        
        async function checkPassword() {
            const input = document.getElementById('passwordInput').value;
            const inputHash = await hashPassword(input);
            
            // Utiliser uniquement le mot de passe par d√©faut
            // Pour changer le mot de passe, contacter l'administrateur par email
            if (inputHash === correctPasswordHash) {
                localStorage.setItem('daaraAuth', 'true');
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                document.getElementById('loginError').classList.add('hidden');
                initApp();
            } else {
                document.getElementById('loginError').classList.remove('hidden');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }
        
        function resetSystem() {
            if (confirm('‚ö†Ô∏è ATTENTION !\n\nCela va supprimer :\n- L\'ancien mot de passe personnalis√© (s\'il existe)\n- Votre session de connexion\n\nLes donn√©es de pr√©sence et les membres seront CONSERV√âS.\n\nContinuer ?')) {
                // Supprimer uniquement les donn√©es d'authentification
                localStorage.removeItem('daaraPasswordHash');
                localStorage.removeItem('daaraAuth');
                alert('‚úÖ Syst√®me r√©initialis√© !\n\nVous pouvez maintenant vous connecter avec le mot de passe par d√©faut : bismillah');
                location.reload();
            }
        }
        
        function logout() {
            localStorage.removeItem('daaraAuth');
            location.reload();
        }
        
        function checkAuth() {
            const isAuth = localStorage.getItem('daaraAuth');
            if (isAuth === 'true') {
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                initApp();
            }
        }
        
        let presenceData = {};
        
        function loadPresenceData() {
            const saved = localStorage.getItem('daaraPresences');
            if (saved) {
                presenceData = JSON.parse(saved);
            }
            
            membres.forEach((membre, idx) => {
                const key = `${membre.prenom}_${membre.nom}_${idx}`;
                if (!presenceData[key]) {
                    presenceData[key] = {};
                }
            });
        }
        
        function savePresenceData() {
            localStorage.setItem('daaraPresences', JSON.stringify(presenceData));
            updateStats();
        }
        
        function togglePresence(memberKey, dateStr) {
            if (!presenceData[memberKey]) {
                presenceData[memberKey] = {};
            }
            
            const current = presenceData[memberKey][dateStr];
            
            if (!current) {
                presenceData[memberKey][dateStr] = 'P';
            } else if (current === 'P') {
                presenceData[memberKey][dateStr] = 'A';
            } else {
                delete presenceData[memberKey][dateStr];
            }
            
            savePresenceData();
            renderTable();
        }
        
        function getConsecutiveAbsences(memberKey) {
            let maxConsecutive = 0;
            let currentConsecutive = 0;
            
            weekendDates.forEach(date => {
                const dateStr = formatDate(date);
                const status = presenceData[memberKey]?.[dateStr];
                
                if (status === 'A') {
                    currentConsecutive++;
                    maxConsecutive = Math.max(maxConsecutive, currentConsecutive);
                } else if (status === 'P') {
                    currentConsecutive = 0;
                }
            });
            
            return maxConsecutive;
        }
        
        function formatDate(date) {
            const d = new Date(date);
            const day = String(d.getDate()).padStart(2, '0');
            const month = String(d.getMonth() + 1).padStart(2, '0');
            return `${day}/${month}`;
        }
        
        function renderTable() {
            const header = document.getElementById('tableHeader');
            const body = document.getElementById('tableBody');
            
            header.innerHTML = '';
            const headerRow = document.createElement('tr');
            
            const nameHeader = document.createElement('th');
            nameHeader.className = 'name-column';
            nameHeader.textContent = 'Membre';
            headerRow.appendChild(nameHeader);
            
            weekendDates.forEach(date => {
                const th = document.createElement('th');
                th.className = 'date-column';
                th.textContent = formatDate(date);
                headerRow.appendChild(th);
            });
            
            header.appendChild(headerRow);
            
            body.innerHTML = '';
            
            membres.forEach((membre, idx) => {
                const memberKey = `${membre.prenom}_${membre.nom}_${idx}`;
                const consecutiveAbsences = getConsecutiveAbsences(memberKey);
                const hasAlert = consecutiveAbsences >= 5;
                
                const row = document.createElement('tr');
                if (hasAlert) {
                    row.className = 'alert-row';
                }
                
                const nameCell = document.createElement('td');
                nameCell.className = 'name-cell';
                nameCell.innerHTML = `${membre.prenom} ${membre.nom}`;
                if (hasAlert) {
                    nameCell.innerHTML += `<span class="alert-badge">‚ö†Ô∏è ${consecutiveAbsences}</span>`;
                }
                row.appendChild(nameCell);
                
                weekendDates.forEach(date => {
                    const dateStr = formatDate(date);
                    const status = presenceData[memberKey]?.[dateStr];
                    
                    const td = document.createElement('td');
                    const cell = document.createElement('div');
                    cell.className = `presence-cell ${status === 'P' ? 'present' : status === 'A' ? 'absent' : 'empty'}`;
                    cell.textContent = status || '‚Äî';
                    cell.onclick = () => togglePresence(memberKey, dateStr);
                    
                    td.appendChild(cell);
                    row.appendChild(td);
                });
                
                body.appendChild(row);
            });
        }
        
        function updateStats() {
            document.getElementById('totalMembers').textContent = membres.length;
            document.getElementById('totalDates').textContent = weekendDates.length;
            
            let alertCount = 0;
            membres.forEach((membre, idx) => {
                const memberKey = `${membre.prenom}_${membre.nom}_${idx}`;
                if (getConsecutiveAbsences(memberKey) >= 5) {
                    alertCount++;
                }
            });
            
            document.getElementById('alertCount').textContent = alertCount;
            document.getElementById('alertCountBtn').textContent = alertCount;
        }
        
        function showAlerts() {
            const alertList = document.getElementById('alertList');
            alertList.innerHTML = '';
            
            let hasAlerts = false;
            
            membres.forEach((membre, idx) => {
                const memberKey = `${membre.prenom}_${membre.nom}_${idx}`;
                const consecutiveAbsences = getConsecutiveAbsences(memberKey);
                
                if (consecutiveAbsences >= 5) {
                    hasAlerts = true;
                    const item = document.createElement('div');
                    item.className = 'alert-item';
                    item.innerHTML = `
                        <div class="alert-item-name">${membre.prenom} ${membre.nom}</div>
                        <div class="alert-item-count">‚ö†Ô∏è ${consecutiveAbsences} absences cons√©cutives</div>
                    `;
                    alertList.appendChild(item);
                }
            });
            
            if (!hasAlerts) {
                alertList.innerHTML = '<div style="text-align:center; color:#10B981; font-weight:800; padding:30px; font-size: 18px;">‚úÖ Aucune alerte active</div>';
            }
            
            document.getElementById('alertModal').classList.remove('hidden');
        }
        
        function closeModal(event) {
            if (!event || event.target.classList.contains('modal-overlay')) {
                document.getElementById('alertModal').classList.add('hidden');
            }
        }
        
        function exportData() {
            const dataStr = JSON.stringify(presenceData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `daara_presences_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }
        
        function showMemberManagement() {
            document.getElementById('memberModal').classList.remove('hidden');
            document.getElementById('newMemberPrenom').value = '';
            document.getElementById('newMemberNom').value = '';
            document.getElementById('memberError').classList.add('hidden');
            document.getElementById('memberSuccess').classList.add('hidden');
            renderMemberList();
        }
        
        function closeMemberModal(event) {
            if (!event || event.target.classList.contains('modal-overlay')) {
                document.getElementById('memberModal').classList.add('hidden');
            }
        }
        
        function addMember() {
            const prenom = document.getElementById('newMemberPrenom').value.trim();
            const nom = document.getElementById('newMemberNom').value.trim();
            
            const errorDiv = document.getElementById('memberError');
            const successDiv = document.getElementById('memberSuccess');
            
            errorDiv.classList.add('hidden');
            successDiv.classList.add('hidden');
            
            if (!prenom || !nom) {
                errorDiv.textContent = '‚ùå Le pr√©nom et le nom sont obligatoires';
                errorDiv.classList.remove('hidden');
                return;
            }
            
            const exists = membres.some(m => 
                m.prenom.toLowerCase() === prenom.toLowerCase() && 
                m.nom.toLowerCase() === nom.toLowerCase()
            );
            
            if (exists) {
                errorDiv.textContent = '‚ùå Ce membre existe d√©j√†';
                errorDiv.classList.remove('hidden');
                return;
            }
            
            membres.push({prenom, nom});
            
            // Trier par nom puis par pr√©nom
            membres.sort((a, b) => {
                const nomCompare = a.nom.localeCompare(b.nom, 'fr');
                if (nomCompare !== 0) return nomCompare;
                return a.prenom.localeCompare(b.prenom, 'fr');
            });
            
            saveMembres();
            
            // Reconstruire les donn√©es de pr√©sence avec les nouveaux indices
            const newPresenceData = {};
            membres.forEach((m, idx) => {
                const oldKey = Object.keys(presenceData).find(key => 
                    key.startsWith(`${m.prenom}_${m.nom}_`)
                );
                const newKey = `${m.prenom}_${m.nom}_${idx}`;
                newPresenceData[newKey] = oldKey ? presenceData[oldKey] : {};
            });
            presenceData = newPresenceData;
            savePresenceData();
            
            successDiv.textContent = `‚úÖ ${prenom} ${nom} a √©t√© ajout√© avec succ√®s !`;
            successDiv.classList.remove('hidden');
            
            document.getElementById('newMemberPrenom').value = '';
            document.getElementById('newMemberNom').value = '';
            
            renderMemberList();
            renderTable();
            updateStats();
        }
        
        function deleteMember(index) {
            const membre = membres[index];
            
            if (!confirm(`Voulez-vous vraiment supprimer ${membre.prenom} ${membre.nom} ?\n\nAttention : Toutes les donn√©es de pr√©sence seront perdues.`)) {
                return;
            }
            
            const memberKey = `${membre.prenom}_${membre.nom}_${index}`;
            delete presenceData[memberKey];
            
            membres.splice(index, 1);
            
            const newPresenceData = {};
            membres.forEach((m, idx) => {
                const oldKey = `${m.prenom}_${m.nom}_${idx > index ? idx + 1 : idx}`;
                const newKey = `${m.prenom}_${m.nom}_${idx}`;
                newPresenceData[newKey] = presenceData[oldKey] || {};
            });
            presenceData = newPresenceData;
            
            saveMembres();
            savePresenceData();
            
            const successDiv = document.getElementById('memberSuccess');
            successDiv.textContent = `‚úÖ ${membre.prenom} ${membre.nom} a √©t√© supprim√©`;
            successDiv.classList.remove('hidden');
            
            renderMemberList();
            renderTable();
            updateStats();
        }
        
        function renderMemberList() {
            const list = document.getElementById('memberList');
            list.innerHTML = '';
            
            if (membres.length === 0) {
                list.innerHTML = '<div style="text-align:center; color:#6B7280; padding:30px; font-weight:600;">Aucun membre</div>';
                return;
            }
            
            membres.forEach((membre, index) => {
                const item = document.createElement('div');
                item.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 16px; background: white; border-radius: 12px; margin-bottom: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s;';
                
                item.onmouseover = () => item.style.transform = 'translateX(5px)';
                item.onmouseout = () => item.style.transform = 'translateX(0)';
                
                const nameDiv = document.createElement('div');
                nameDiv.style.cssText = 'font-weight: 800; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;';
                nameDiv.textContent = `${membre.prenom} ${membre.nom}`;
                
                const deleteBtn = document.createElement('button');
                deleteBtn.style.cssText = 'background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; padding: 10px 18px; border-radius: 10px; cursor: pointer; font-weight: 700; transition: all 0.3s; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);';
                deleteBtn.textContent = 'üóëÔ∏è Supprimer';
                deleteBtn.onmouseover = function() {
                    this.style.transform = 'translateY(-2px)';
                    this.style.boxShadow = '0 6px 20px rgba(239, 68, 68, 0.5)';
                };
                deleteBtn.onmouseout = function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 4px 15px rgba(239, 68, 68, 0.4)';
                };
                deleteBtn.onclick = function() {
                    deleteMember(index);
                };
                
                item.appendChild(nameDiv);
                item.appendChild(deleteBtn);
                list.appendChild(item);
            });
        }
        
 